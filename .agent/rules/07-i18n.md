---
alwaysApply: true
---

# Internationalization (i18n)

## Overview

This app uses a custom i18n implementation with `next-intl` patterns.

| Feature | Implementation |
|---------|----------------|
| Provider | `@/components/providers/i18n-provider.tsx` |
| Hook | `useI18n()` |
| Locales | English (`en`), Vietnamese (`vi`) |
| Storage | `localStorage` key: `app-locale` |
| Fallback | English (default) |

## 19 Namespaces

Translation files are in `@/i18n/locales/{en,vi}/`:

| Namespace | Content |
|-----------|---------|
| `admin` | Admin panel pages and components |
| `article` | Article viewing and management |
| `auth` | Authentication (login, register, OTP) |
| `characters` | Character management |
| `comments` | Comment system |
| `common` | Shared UI elements and actions |
| `demo` | Demo/example pages |
| `home` | Homepage content |
| `media` | Media management |
| `organizations` | Organization pages |
| `permissions` | Permission management |
| `profile` | User profile |
| `series` | Series management |
| `settings` | User settings |
| `staff` | Staff management |
| `tags` | Tag management |
| `toast` | Toast notifications |
| `user` | User-related content |
| `write` | Article writing |

## Translation Function

```typescript
const { t } = useI18n();

// Signature
t(key: string, namespace?: string, variables?: Record<string, unknown>, fallback?: string): string
```

### Basic Usage

```typescript
// With namespace (REQUIRED)
t("actions.edit", "common")           // "Edit"
t("studios.pageTitle", "admin")       // "Studios Management"

// With variables
t("studios.list.deleteConfirm", "admin", { name: "Studio A" })
// "Are you sure you want to delete Studio A?"

// With fallback
t("some.key", "common", {}, "Default text")
```

## Key Structure

### common.json Structure

```json
{
  "actions": {
    "edit": "Edit",
    "view": "View",
    "delete": "Delete",
    "save": "Save",
    "cancel": "Cancel",
    "create": "Create",
    "search": "Search",
    "filter": "Filter",
    "clear": "Clear",
    "submit": "Submit",
    "confirm": "Confirm",
    "back": "Back",
    "next": "Next"
  },
  "common": {
    "actions": "Actions",
    "loading": "Loading...",
    "noData": "No data available"
  },
  "viewDetails": "View Details",
  "admin": "Admin"
}
```

### Domain Namespace Structure

```json
// admin.json
{
  "studios": {
    "pageTitle": "Studios Management",
    "pageDescription": "Manage animation studios",
    "list": {
      "title": "Studios",
      "description": "All registered studios",
      "name": "Name",
      "deleteConfirm": "Delete {{name}}?"
    },
    "detail": {
      "title": "Studio Details",
      "series": {
        "title": "Series by this studio"
      }
    }
  }
}
```

## Correct vs Wrong Patterns

### Action Verbs

```typescript
// ✅ CORRECT: Action verbs are in actions.*
t("actions.edit", "common")
t("actions.view", "common")
t("actions.delete", "common")
t("actions.save", "common")

// ❌ WRONG: Don't prefix with common.
t("common.edit", "common")    // Key doesn't exist
t("common.view", "common")    // Key doesn't exist
```

### Labels

```typescript
// ✅ CORRECT: Labels are in common.*
t("common.actions", "common")   // Returns "Actions" (the label)
t("common.loading", "common")   // Returns "Loading..."

// ❌ WRONG: Confusing label with action
t("actions.actions", "common")  // Key doesn't exist
```

### Domain Content

```typescript
// ✅ CORRECT: Use domain namespace
t("studios.pageTitle", "admin")
t("studios.list.name", "admin")
t("series.detail.title", "series")

// ❌ WRONG: Action verbs are in common, not admin
t("actions.edit", "admin")      // Key doesn't exist in admin
```

### Namespace Parameter

```typescript
// ✅ CORRECT: Always specify namespace
t("actions.edit", "common")

// ❌ WRONG: Missing namespace (defaults to "common" but unclear)
t("actions.edit")
```

## Usage in Components

```tsx
"use client";

import { useI18n } from "@/components/providers/i18n-provider";

export function MyComponent() {
  const { t, locale, setLocale, isLoading, isReady } = useI18n();
  
  // Wait for translations to load
  if (!isReady) return <Skeleton />;
  
  return (
    <div>
      <h1>{t("pageTitle", "admin")}</h1>
      <Button onClick={() => setLocale("vi")}>
        {t("actions.switchLanguage", "common")}
      </Button>
    </div>
  );
}
```

## Page Metadata

```tsx
import { usePageMetadata } from "@/hooks/ui/use-page-metadata";
import { useI18n } from "@/components/providers/i18n-provider";

export default function StudiosPage() {
  const { t } = useI18n();
  
  usePageMetadata({
    title: t("studios.pageTitle", "admin"),
    description: t("studios.pageDescription", "admin"),
  });
  
  return <div>...</div>;
}
```

## Adding New Translations

1. Add key to `src/i18n/locales/en/{namespace}.json`
2. Add same key to `src/i18n/locales/vi/{namespace}.json`
3. Use in component: `t("key.path", "namespace")`

## Verification Checklist

Before using a translation key:

- [ ] Key exists in the JSON file
- [ ] Namespace is correct
- [ ] Key path matches JSON structure
- [ ] Both EN and VI locales have the key
- [ ] Variables are provided if needed

## Best Practices

1. **Always specify namespace** - Second parameter is required
2. **Use dot notation** - `t("studios.list.name", "admin")`
3. **Provide variables** - `t("key", "ns", { name: value })`
4. **Add fallback for new keys** - `t("key", "ns", {}, "Fallback")`
5. **Check isReady** - Wait for translations to load
6. **Keep keys organized** - Follow existing structure

## Anti-Patterns

```typescript
// ❌ WRONG: Missing namespace
t("actions.edit")

// ❌ WRONG: Wrong namespace for action verbs
t("actions.edit", "admin")  // actions.* is in common

// ❌ WRONG: Hardcoded text
<Button>Edit</Button>  // Should use t()

// ❌ WRONG: Wrong key path
t("common.view", "common")  // Should be t("actions.view", "common")

// ❌ WRONG: Not providing variables
t("deleteConfirm", "admin")  // Missing { name } variable
```
